id: test

info:
  name: test
  author: zb
  sverity: high

set:
  myurl: request.url
  url: myurl
  d: replaceAll("http://example.com/xxxx", url, "http://xx.com")
  randstr_url: randomLowercase(8)
  randstr_content: randomLowercase(8)
  base64_content: base64(string(randstr_content))
  z: "More information..."
rules:
  r0:
    request:
      method: GET
      path: /{{d}}
      headers:
        X-Forwarded-For: "{{randstr_url}}"
        X-Original-URL: "{{base64_content}}"
    expression: response.body.bcontains(b'{{z}}')
expression: r0()
